title: 三消洗牌算法思路
categories:
- 三消
tags:
- 洗牌

-------


三消洗牌算法
=============

基本概念
---------------

###三消可行空间：
即通过两个元素交换能够形成三消的一个物理空间结构。这里将导致不能形成三消的关键点称为X，其他的点称为Y的话。可行解空间由主方向（连续两个YY）带上副方向（单独的Y）组成的模式和三个单独的（Y）两种模型。总计一个X点不考虑限制的话有4*3+4=16种可行解空间。

###洗牌：
对不同种类不同数量的元素，放入一定顺序的格子中，达到某种条件的排序组合的某一种解。


基本思路
---------------
保证有可行操作，并且是稳定的局面。

- 保证有可行解空间

- 选择可行解空间，放入可以交换的解

- 将剩下的元素，填入形成稳定局面

对场面的进行最好条件的组合，如果不能形成解，那么就是没解。


基本实现
----------------

 1. 统计出场面能参与洗牌的元素
 2. 对所有可以操作的空间，初始化其可以选择的元素。
 3. 根据当前局面，将空间中状态更行。比如不能参加洗牌的元素使得某个格子只能选某种颜色，那就填入该颜色；或者现在某个空间只能是黄色或者蓝色等等情况。
 4. 针对能形成可行解空间多少的点排序，选择可形成最少可行解空间的点填上不能参与解的元素。
 5. 重复4直到所有不能参与形成解的元素填入完成。
 6. 针对能形成可行解空间多少的点排序，选择可形成最多可行解空间的点，选择某个可行解空间，某个可行解元素。
 7. 执行3，再执行6。直至不存在可行解点（这里可以在尽量保证n个解的时候，停止）
 8. 执行3，然后对空间任意填上剩下元素。
 
 步骤6需要对空间点和选择颜色做笛卡尔积的组合遍历，步骤8需要队列排序。
 通过动态更新和递归遍历，即可完成。
